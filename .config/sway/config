# vim:foldmethod=marker:foldlevel=0

# General settings {{{1

xwayland disable
default_border pixel 1
default_floating_border pixel 2

smart_borders on
smart_gaps on
hide_edge_borders --i3 smart_no_gaps
focus_wrapping yes

gaps inner 0

font monospace 10
titlebar_border_thickness 1
titlebar_padding 6 1

seat * xcursor_theme Yaru 24
seat * hide_cursor 5000

# Autostart {{{1

exec mako
exec pipewire
exec gammastep
exec foot --server
exec light -S 35
exec wl-paste -t text --watch clipman store --max-items=50
exec clipman restore
exec mkfifo $SWAYSOCK.wob && tail -f $SWAYSOCK.wob | wob -a top -a left -W 200 -H 20 -M 8 -o 2 -b 2 -p 2
exec /usr/libexec/polkit-gnome-authentication-agent-1

set $gnome-schema org.gnome.desktop.interface
exec_always {
    gsettings set $gnome-schema gtk-theme 'Yaru-light'
    gsettings set $gnome-schema icon-theme 'Yaru'
    gsettings set $gnome-schema cursor-theme 'Yaru'
    gsettings set $gnome-schema cursor-size 24
    gsettings set $gnome-schema font-name 'sans-serif 10'
    gsettings set $gnome-schema monospace-font-name 'monospace 10'
}

# Variables {{{1

set $term 'footclient'
# set $drun 'j4-dmenu-desktop --no-generic --usage-log=tmp/j4.log --display-binary --term=footclient --dmenu=bemenu'
set $drun 'wofi'
set $lock 'swaylock -f -c 000000'
set $clipboard 'clipman pick -t wofi'

set $mod Mod4
set $left h
set $down j
set $up k
set $right l

# Idle config {{{1

exec swayidle -w \
	timeout 600 'swaylock -f -c 000000' \
	timeout 1200 'loginctl suspend' \
	before-sleep 'swaylock -f -c 000000'

bindswitch lid:toggle exec $lock

# Outputs {{{1

set $laptop eDP-1
set $mon1 DP-1
set $mon2 DP-2

output $laptop scale 2
output $mon1 resolution 3840x2160 scale 2 position 1920 0
output $mon2 resolution 3840x2160 scale 2

output * bg #222222 solid_color

# Inputs {{{1

input "type:keyboard" {
   xkb_layout us,ru
   repeat_delay 200
   repeat_rate 30
   xkb_options grp:alt_space_toggle
}

input "1:1:AT_Translated_Set_2_keyboard" {
   xkb_options grp:alt_space_toggle,ctrl:nocaps,altwin:swap_lalt_lwin
}

input "type:touchpad" {
    # dwt enabled
    tap enabled
    natural_scroll enabled
    middle_emulation disabled
    accel_profile adaptive
    drag enabled
    scroll_factor 0.5
    # pointer_accel 1
}

input "type:pointer" {
    accel_profile flat
    pointer_accel 0
}

# Colors {{{1

set $col_hl         #87d7ff99
set $col_hl_br      #87d7ff
set $col_bg         #303030
set $col_bg_br      #444444
set $col_fg         #d7d7d7

# Colors                 border		 background	 text	  indicator	  child_border
client.focused           $col_hl     $col_hl     $col_fg  $col_hl_br  $col_hl
client.focused_inactive  $col_bg_br  $col_bg_br  $col_fg  $col_bg_br  $col_bg_br
client.unfocused         $col_bg_br  $col_bg     $col_fg  $col_bg_br  $col_bg_br
# client.urgent             $color_bright_yellow   $color_bright_yellow   $color_normal_black    $color_unused        $color_unused
# client.placeholder        $color_unused          $color_unused          $color_unused          $color_unused        $color_unused

# Rules {{{1

# for_window [ class="^.*"                ] inhibit_idle fullscreen
# for_window [ app_id="^.*"               ] inhibit_idle fullscreen
for_window [ class="^Firefox$"          ] inhibit_idle fullscreen
for_window [ app_id="^firefox$"         ] inhibit_idle fullscreen
for_window [ app_id="pavucontrol"       ] focus, floating enable
for_window [ title="Picture-in-Picture" ] floating enable
for_window [ app_id="mpv"               ] floating enable
for_window [ app_id="^launcher$"        ] floating enable
for_window [ app_id="dmenu.*"           ] floating enable
for_window [ app_id="^popup$"           ] floating enable

# Key bindings {{{1

# General {{{2
   floating_modifier $mod normal

   bindsym $mod+Shift+Return exec $term
   bindsym $mod+d exec $drun
   bindsym $mod+Control+c exec $clipboard
   bindsym Mod1+Tab exec window-switcher

   bindsym $mod+Shift+c kill
   bindsym $mod+Backspace reload

   bindsym XF86MonBrightnessUp exec light -A 10 && light -G | cut -d'.' -f1 > $SWAYSOCK.wob
   bindsym XF86MonBrightnessDown exec light -U 10 && light -G | cut -d'.' -f1 > $SWAYSOCK.wob
   bindsym Mod1+XF86MonBrightnessUp exec light -s sysfs/backlight/ddcci5 -A 10 && light -s sysfs/backlight/ddcci5 -G | cut -d'.' -f1 > $SWAYSOCK.wob
   bindsym Mod1+XF86MonBrightnessDown exec light -s sysfs/backlight/ddcci5 -U 10 && light -s sysfs/backlight/ddcci5 -G | cut -d'.' -f1 > $SWAYSOCK.wob
   bindsym XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle
   bindsym XF86AudioRaiseVolume exec pamixer -ui 5 && dc -e "[`pamixer --get-volume`]sM 100d `pamixer --get-volume`<Mp" > $SWAYSOCK.wob
   bindsym XF86AudioLowerVolume exec pamixer -ud 5 && dc -e "[`pamixer --get-volume`]sM 100d `pamixer --get-volume`<Mp" > $SWAYSOCK.wob
   bindsym XF86AudioMute exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $SWAYSOCK.wob ) || dc -e "[`pamixer --get-volume`]sM 100d `pamixer --get-volume`<Mp" > $SWAYSOCK.wob
   bindsym XF86AudioPlay exec playerctl play-pause
   bindsym XF86AudioPrev exec playerctl previous
   bindsym XF86AudioNext exec playerctl next

   bindsym $mod+Control+equal gaps inner current plus 4
   bindsym $mod+Control+minus gaps inner current minus 4

   bindsym $mod+Escape exec makoctl dismiss
   bindsym $mod+Control+Escape exec makoctl dismiss -a

# Moving around {{{2

    bindsym $mod+$left focus left
    bindsym $mod+$down focus down
    bindsym $mod+$up focus up
    bindsym $mod+$right focus right

    bindsym $mod+Shift+$left move left
    bindsym $mod+Shift+$down move down
    bindsym $mod+Shift+$up move up
    bindsym $mod+Shift+$right move right

    bindsym $mod+comma focus output left
    bindsym $mod+period focus output right

    bindsym $mod+Shift+comma move output left
    bindsym $mod+Shift+period move output right

    bindsym $mod+Ctrl+k focus parent
    bindsym $mod+Ctrl+j focus child

# Workspaces {{{2

    # Switch to workspace
    bindsym $mod+tab workspace back_and_forth
    bindsym $mod+1 workspace number 1
    bindsym $mod+2 workspace number 2
    bindsym $mod+3 workspace number 3
    bindsym $mod+4 workspace number 4
    bindsym $mod+5 workspace number 5
    bindsym $mod+6 workspace number 6
    bindsym $mod+7 workspace number 7
    bindsym $mod+8 workspace number 8
    bindsym $mod+9 workspace number 9
    bindsym $mod+Shift+1 move container to workspace number 1
    bindsym $mod+Shift+2 move container to workspace number 2
    bindsym $mod+Shift+3 move container to workspace number 3
    bindsym $mod+Shift+4 move container to workspace number 4
    bindsym $mod+Shift+5 move container to workspace number 5
    bindsym $mod+Shift+6 move container to workspace number 6
    bindsym $mod+Shift+7 move container to workspace number 7
    bindsym $mod+Shift+8 move container to workspace number 8
    bindsym $mod+Shift+9 move container to workspace number 9

# Layout stuff {{{2

    bindsym $mod+v splitt

    bindsym $mod+w layout tabbed
    bindsym $mod+s layout stacking
    bindsym $mod+e layout toggle split

    bindsym $mod+f fullscreen

    bindsym $mod+Shift+space floating toggle
    bindsym $mod+space focus mode_toggle

# Scratchpad {{{2

    bindsym $mod+Shift+minus move scratchpad
    bindsym $mod+minus scratchpad show


# Resize mode {{{2

set $mode_resize "<< RESIZE >>"
mode $mode_resize {
   bindsym $left resize shrink width 10
   bindsym $down resize grow height 10
   bindsym $up resize shrink height 10
   bindsym $right resize grow width 10

   # Return to default mode
   bindsym Return mode "default"
   bindsym Escape mode "default"
 }
 bindsym $mod+r mode $mode_resize

# Menu mode {{{2

set $powermode "<< [e]xit  [r]eebot  [l]ock  >>"

mode $powermode {
   bindsym e exec swaymsg exit
   bindsym r exec loginctl reboot
   bindsym l exec $lock; mode "default"

   # Return to default mode
   bindsym Return mode "default"
   bindsym Escape mode "default"
}

bindsym $mod+Shift+Backspace mode $powermode

# Status Bar {{{1

bar {
   swaybar_command waybar
   # status_command luastatus-sway.sh
   # height 16
   # position bottom
   # separator_symbol " | "
   # status_edge_padding 12

   # colors {
   #    focused_workspace	    #00000066 #00000077 #FFFFFF99
   #    active_workspace	    #000000FF #000000FF #FFFFFF99
   #    inactive_workspace    #000000FF #000000FF #FFFFFF66
   #    binding_mode	    $col_accent $col_accent #FFFFFF
   #    separator		    #00000044
   #    statusline	    #999999
   #    background	    #000000FF
   #    focused_background    #000000FF
   # }
}

include /etc/sway/config.d/*
