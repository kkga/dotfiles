# General settings -------------------------------------------------------------

# xwayland disable
default_border pixel 1
default_floating_border pixel 1

smart_borders on
smart_gaps on
hide_edge_borders --i3 smart_no_gaps
focus_wrapping yes

font pango: monospace 9
titlebar_border_thickness 0
titlebar_padding 4 0

seat * xcursor_theme Adwaita 24
seat * hide_cursor 10000

# Variables ------------------------------------------------------------------

set $term 'footclient'
set $floatterm 'foot -a popup'
set $drun 'sway-launcher'
set $clipboard 'sway-clipmenu'

set $mod Mod4
set $left h
set $down j
set $up k
set $right l

# Outputs ------------------------------------------------------------------

set $laptop eDP-1
set $mon1 DP-1
set $mon2 DP-2

# output $laptop scale 2
output $mon1 resolution 3840x2160 scale 2 position 1920 0 subpixel rgb
output $mon2 resolution 3840x2160 scale 2 subpixel rgb
output $laptop subpixel rgb

output * bg #111111 solid_color

bindswitch --locked lid:on exec loginctl lock-session, output $laptop dpms off
bindswitch --locked lid:off output $laptop dpms on

# Inputs ------------------------------------------------------------------

input "type:keyboard" {
   xkb_layout us,ru
   repeat_delay 200
   repeat_rate 30
   xkb_options grp:alt_space_toggle
}

input "1:1:AT_Translated_Set_2_keyboard" {
   xkb_options grp:alt_space_toggle,ctrl:nocaps,altwin:swap_lalt_lwin
}

input "type:touchpad" {
    dwt disabled
    tap enabled
    natural_scroll enabled
    middle_emulation disabled
    accel_profile adaptive
    drag enabled
    scroll_factor 0.5
    pointer_accel 0.25
}

input "type:pointer" {
    accel_profile adaptive
    pointer_accel -0.5
}

# Colors ------------------------------------------------------------------

set $col_hl         #5F5F87
set $col_hl_br      #8787AF
set $col_bg         #303030
set $col_bg_br      #111111
set $col_fg         #d7d7d7
set $col_fg_dim     #999999

# Colors                 border		 background	 text	  indicator	  child_border
client.focused           $col_hl     $col_hl     $col_fg  $col_hl_br  $col_hl
client.focused_inactive  $col_bg_br  $col_bg_br  $col_fg  $col_bg_br  $col_bg_br
client.unfocused         $col_bg_br  $col_bg     $col_fg  $col_bg_br  $col_bg_br
# client.urgent             $color_bright_yellow   $color_bright_yellow   $color_normal_black    $color_unused        $color_unused
# client.placeholder        $color_unused          $color_unused          $color_unused          $color_unused        $color_unused

# Rules ------------------------------------------------------------------

for_window [ class="^Firefox$"                   ] inhibit_idle fullscreen
for_window [ app_id="^firefox$"                  ] inhibit_idle fullscreen
for_window [ app_id="pavucontrol"                ] focus, floating enable
for_window [ title="Htop*"                       ] floating enable
for_window [ title="Picture-in-Picture"          ] floating enable
for_window [ title="Firefox â€” Sharing Indicator" ] floating enable
for_window [ class="Jitsi Meet"                  ] floating enable
for_window [ app_id="spot"                       ] floating enable
for_window [ app_id="mpv"                        ] floating enable
for_window [ app_id="(?i)popup"                  ] floating enable, resize set width 100ppt height 40ppt, move position 0px 0px

# Key bindings ------------------------------------------------------------------

floating_modifier $mod             normal

bindsym $mod+Shift+Return          fullscreen disable, exec $term
bindsym $mod+Control+Return        fullscreen disable, exec $floatterm
bindsym $mod+d                     fullscreen disable, exec $drun
bindsym $mod+c                     fullscreen disable, exec $clipboard
bindsym Mod1+Tab                   fullscreen disable, exec window-switcher
bindsym $mod+Shift+c               kill
bindsym $mod+Shift+Backspace       reload; exec killall -SIGUSR2 waybar
bindsym XF86Display                output * dpms on
bindsym XF86MonBrightnessUp        exec light -A 10 && light -G | cut -d'.' -f1 > $SWAYSOCK.wob
bindsym XF86MonBrightnessDown      exec light -U 10 && light -G | cut -d'.' -f1 > $SWAYSOCK.wob
bindsym Mod1+XF86MonBrightnessUp   exec light -s sysfs/backlight/ddcci5 -A 10 && light -s sysfs/backlight/ddcci5 -G | cut -d'.' -f1 > $SWAYSOCK.wob
bindsym Mod1+XF86MonBrightnessDown exec light -s sysfs/backlight/ddcci5 -U 10 && light -s sysfs/backlight/ddcci5 -G | cut -d'.' -f1 > $SWAYSOCK.wob
bindsym XF86AudioMicMute           exec pactl set-source-mute @DEFAULT_SOURCE@ toggle
bindsym XF86AudioRaiseVolume       exec pamixer -ui 5 && pamixer --get-volume > $SWAYSOCK.wob
bindsym XF86AudioLowerVolume       exec pamixer -ud 5 && pamixer --get-volume > $SWAYSOCK.wob
bindsym XF86AudioMute              exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $SWAYSOCK.wob ) || pamixer --get-volume > $SWAYSOCK.wob
bindsym XF86AudioPlay              exec playerctl play-pause
bindsym XF86AudioPrev              exec playerctl previous
bindsym XF86AudioNext              exec playerctl next
bindsym XF86Wlan                   exec sleep 1 && notify-send "WiFi" "Powered: $(iwctl device wlan0 show | grep Powered | awk '{print $4}')"
bindsym $mod+Escape                exec makoctl dismiss -a
bindsym $mod+o                     exec makoctl menu $DMENU_PROGRAM

bindsym $mod+$left                focus left
bindsym $mod+$down                focus down
bindsym $mod+$up                  focus up
bindsym $mod+$right               focus right

bindsym $mod+Shift+$left          move left
bindsym $mod+Shift+$right         move right
bindsym $mod+Shift+$down          move down
bindsym $mod+Shift+$up            move up

bindsym $mod+comma                focus output left
bindsym $mod+period               focus output right

bindsym $mod+Shift+comma          move output left
bindsym $mod+Shift+period         move output right
bindsym $mod+Control+Shift+comma  move workspace to output left
bindsym $mod+Control+Shift+period move workspace to output right

bindsym $mod+Ctrl+k               focus parent
bindsym $mod+Ctrl+j               focus child

bindsym $mod+tab                  workspace back_and_forth
bindsym $mod+1                    workspace number 1
bindsym $mod+2                    workspace number 2
bindsym $mod+3                    workspace number 3
bindsym $mod+4                    workspace number 4
bindsym $mod+5                    workspace number 5
bindsym $mod+6                    workspace number 6
bindsym $mod+7                    workspace number 7
bindsym $mod+8                    workspace number 8
bindsym $mod+9                    workspace number 9
bindsym $mod+minus                scratchpad show
bindsym $mod+Shift+1              move container to workspace number 1
bindsym $mod+Shift+2              move container to workspace number 2
bindsym $mod+Shift+3              move container to workspace number 3
bindsym $mod+Shift+4              move container to workspace number 4
bindsym $mod+Shift+5              move container to workspace number 5
bindsym $mod+Shift+6              move container to workspace number 6
bindsym $mod+Shift+7              move container to workspace number 7
bindsym $mod+Shift+8              move container to workspace number 8
bindsym $mod+Shift+9              move container to workspace number 9
bindsym $mod+Shift+minus          move scratchpad

bindsym $mod+v                    splitt
bindsym $mod+w                    layout tabbed
bindsym $mod+s                    layout stacking
bindsym $mod+e                    layout toggle split
bindsym $mod+f                    fullscreen
bindsym $mod+Shift+t              floating toggle
bindsym $mod+t                    focus mode_toggle

set $mode_resize                  "RESIZE"
mode $mode_resize {
    bindsym $left                 resize shrink width 20
    bindsym $down                 resize grow height 20
    bindsym $up                   resize shrink height 20
    bindsym $right                resize grow width 20
    bindsym minus                 gaps inner current minus 8px
    bindsym equal                 gaps inner current plus 8px
    bindsym Return                mode "default"
    bindsym Escape                mode "default"
}
bindsym $mod+r                    mode $mode_resize

set $mode_power                   "E exit | R reebot | L lock | S suspend | P poweroff"
mode $mode_power {
    bindsym e                     exec swaymsg exit
    bindsym r                     exec loginctl reboot
    bindsym l                     exec loginctl lock-session; mode "default"
    bindsym s                     exec loginctl suspend
    bindsym p                     exec loginctl poweroff
    bindsym Return                mode "default"
    bindsym Escape                mode "default"
}
bindsym $mod+Control+q            mode $mode_power

# Autostart ------------------------------------------------------------------

exec wl-paste -t text --watch clipman store --max-items=50
exec clipman restore

set $gnome-schema org.gnome.desktop.interface
exec_always {
    gsettings set $gnome-schema gtk-theme 'Adwaita'
    gsettings set $gnome-schema icon-theme 'Adwaita'
    gsettings set $gnome-schema cursor-theme 'Adwaita'
    gsettings set $gnome-schema cursor-size 24
    gsettings set $gnome-schema font-name 'sans-serif 10'
    gsettings set $gnome-schema monospace-font-name 'monospace 10'
    gsettings set $gnome-schema font-hinting 'slight'
    gsettings set $gnome-schema font-antialiasing 'grayscale'
    gsettings set org.gnome.desktop.default-applications.terminal exec $term
    gsettings set org.gnome.desktop.default-applications.terminal exec-arg ''
    gsettings set org.gnome.desktop.wm.preferences button-layout ''
}

# Includes ---------------------------------------------------------------

include /etc/sway/config.d/*
include ~/.config/sway/$(hostname).conf

exec runsvdir ~/.local/service/ 'log: ...........................................................................................................................................................................................................................................................................................................................................................................................................'
