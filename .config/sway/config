# vim:foldmethod=marker:foldlevel=0

# Autostart {{{1

exec mako
exec pipewire
exec syncthing -no-browser
exec light -S 50
exec wlsunset -l 55 -L 37 -t 4000 -T 6500
exec wl-paste -t text --watch clipman store
exec clipman restore
exec foot -s
exec mkfifo $SWAYSOCK.wob && tail -f $SWAYSOCK.wob | wob

set $gnome-schema org.gnome.desktop.interface
exec_always {
    gsettings set $gnome-schema gtk-theme 'Adwaita'
    gsettings set $gnome-schema icon-theme 'Adwaita'
    gsettings set $gnome-schema cursor-theme 'Adwaita'
    gsettings set $gnome-schema cursor-size 24
    gsettings set $gnome-schema font-name 'sans-serif 10'
    gsettings set $gnome-schema monospace-font-name 'monospace 10'
}

# Variables {{{1

set $term 'footclient'
set $run 'bemenu-run | xargs swaymsg exec --'
set $drun 'j4-dmenu-desktop --no-generic --usage-log=tmp/j4.log --display-binary --term=footclient --dmenu=bemenu'
set $lock 'swaylock -f -c 333333'
set $clipboard 'clipman pick -t bemenu'

set $col_white  #EEEEEE
set $col_gray_light  #FFFFFF99
set $col_gray #00000033
set $col_gray_dark #00000066
set $col_accent #ff0000
set $col_black #000000
set $col_sel #d75f00
set $col_bg #84998F

set $ws1 1
set $ws2 2
set $ws3 3
set $ws4 4
set $ws5 5
set $ws6 6

set $mod Mod4
set $left h
set $down j
set $up k
set $right l

# Idle config {{{1

exec swayidle -w \
	timeout 300 'swaylock -f -c 333333' \
	timeout 600 'loginctl suspend' \
	before-sleep 'swaylock -f -c 333333'

# Outputs {{{1

set $laptop eDP-1
set $mon1 DP-1
set $mon2 DP-2

output * bg $col_bg solid_color
output * adaptive_sync on
output $laptop resolution 2560x1600 scale 2
output $mon1 resolution 3840x2160 scale 2 position 1920 0
output $mon2 resolution 3840x2160 scale 2


bindswitch lid:toggle exec $lock

# Inputs {{{1

input "type:keyboard" {
   xkb_layout us,ru
   repeat_delay 200
   repeat_rate 30
}

input "1:1:AT_Translated_Set_2_keyboard" {
   xkb_options grp:shifts_toggle,ctrl:nocaps,altwin:swap_lalt_lwin
}

input "type:touchpad" {
    dwt disabled
    tap enabled
    natural_scroll enabled
    middle_emulation disabled
    accel_profile adaptive
    drag enabled
    # pointer_accel 1
    # scroll_factor 1
}

input "type:pointer" {
    accel_profile adaptive
    pointer_accel 0
}


# General settings {{{1

xwayland disable
default_border pixel
default_floating_border pixel

smart_borders on
smart_gaps on
hide_edge_borders --i3 smart_no_gaps
focus_wrapping yes

gaps inner 8

font pango:monospace 9
titlebar_border_thickness 1
titlebar_padding 4 1

seat * xcursor_theme Adwaita 24

# Colors {{{1

# Colors                  border                 background             text                   indicator            child_border
client.focused            $col_black		 $col_black     	$col_white   	       $col_accent        $col_black
client.focused_inactive   $col_gray_dark         $col_gray_dark            $col_white           $col_gray         $col_gray
client.unfocused          $col_gray_dark 	 $col_gray            $col_gray_light           $col_gray        $col_gray
# client.urgent             $color_bright_yellow   $color_bright_yellow   $color_normal_black    $color_unused        $color_unused
# client.placeholder        $color_unused          $color_unused          $color_unused          $color_unused        $color_unused



# Rules {{{1
# for_window      [app_id=".*"]           split toggle
#for_window 	[app_id="firefox"] 	move container to workspace number $ws1
for_window      [app_id="^launcher$"]   floating enable


# Key bindings {{{1

# General {{{2
   floating_modifier $mod normal

   bindsym $mod+Return exec $term
   bindsym $mod+p exec $drun
   bindsym $mod+Control+p exec $run
   bindsym $mod+Control+c exec $clipboard

   bindsym XF86MonBrightnessUp exec light -A 5 && light -G | cut -d'.' -f1 > $SWAYSOCK.wob
   bindsym XF86MonBrightnessDown exec light -U 5 && light -G | cut -d'.' -f1 > $SWAYSOCK.wob

   bindsym XF86AudioRaiseVolume exec pamixer -ui 5 && pamixer --get-volume > $SWAYSOCK.wob
   bindsym XF86AudioLowerVolume exec pamixer -ud 5 && pamixer --get-volume > $SWAYSOCK.wob
   bindsym XF86AudioMute exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $SWAYSOCK.wob ) || pamixer --get-volume > $SWAYSOCK.wob

   bindsym $mod+Shift+c kill
   bindsym $mod+Backspace reload

   bindsym $mod+Control+equal gaps inner current plus 4
   bindsym $mod+Control+minus gaps inner current minus 4

   bindsym $mod+Escape exec makoctl dismiss

# Moving around {{{2

    bindsym $mod+$left focus left
    bindsym $mod+$down focus down
    bindsym $mod+$up focus up
    bindsym $mod+$right focus right

    # bindsym $mod+j focus next
    # bindsym $mod+k focus prev

    bindsym $mod+Shift+$left move left
    bindsym $mod+Shift+$down move down
    bindsym $mod+Shift+$up move up
    bindsym $mod+Shift+$right move right


# Workspaces {{{2

    # Switch to workspace
    bindsym $mod+tab workspace back_and_forth
    bindsym $mod+q workspace $ws1
    bindsym $mod+w workspace $ws2
    bindsym $mod+e workspace $ws3
    bindsym $mod+r workspace $ws4
    bindsym $mod+t workspace $ws5
    bindsym $mod+y workspace $ws6
    bindsym $mod+Shift+q move container to workspace $ws1
    bindsym $mod+Shift+w move container to workspace $ws2
    bindsym $mod+Shift+e move container to workspace $ws3
    bindsym $mod+Shift+r move container to workspace $ws4
    bindsym $mod+Shift+t move container to workspace $ws5
    bindsym $mod+Shift+y move container to workspace $ws6


# Layout stuff {{{2

    bindsym $mod+v splitt

    bindsym $mod+z layout tabbed
    bindsym $mod+x layout toggle split

    bindsym $mod+f fullscreen

    bindsym $mod+Shift+space floating toggle
    bindsym $mod+space focus mode_toggle

    bindsym $mod+Ctrl+k focus parent
    bindsym $mod+Ctrl+j focus child


# Scratchpad {{{2

    bindsym $mod+Shift+minus move scratchpad
    bindsym $mod+minus scratchpad show


# Resize mode {{{2

mode "resize" {
   bindsym $left resize shrink width 10
   bindsym $down resize grow height 10
   bindsym $up resize shrink height 10
   bindsym $right resize grow width 10

   # Return to default mode
   bindsym Return mode "default"
   bindsym Escape mode "default"
 }
 bindsym $mod+Control+r mode "resize"

# Menu mode {{{2

mode "[E]XIT -- [R]EBOOT -- [L]OCK" {
   bindsym e exec swaymsg exit
   bindsym r exec loginctl reboot
   bindsym l exec $lock; mode "default"

   # Return to default mode
   bindsym Return mode "default"
   bindsym Escape mode "default"
}

bindsym $mod+Shift+Backspace mode "[E]XIT -- [R]EBOOT -- [L]OCK"

# Status Bar {{{1

bar {
   status_command sway-luastatus.sh
   # status_command i3status-rs $HOME/.config/sway/status.toml
   font pango:monospace 9
   height 14
   position bottom
   strip_workspace_name yes
   pango_markup enabled
   separator_symbol "|"

   colors {
      focused_workspace #555555 #444444 #EEEEEE
      inactive_workspace #333333 #222222 #888888
      binding_mode $col_accent $col_accent #FFFFFF
      separator #666666
      statusline #cccccc
   }
}

include /etc/sway/config.d/*
