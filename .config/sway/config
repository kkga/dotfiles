# vim:foldmethod=marker:foldlevel=0

# Autostart {{{1
xwayland disable
exec mako
exec syncthing -no-browser
exec gammastep -l 55:37
exec wl-paste -t text --watch clipman store 1>> ~/tmp/clipman.log 2>&1
exec wl-paste -p -t text --watch clipman store -P --histpath="~/.local/share/clipman-primary.json"
exec mkfifo $SWAYSOCK.wob && tail -f $SWAYSOCK.wob | wob
exec /usr/libexec/polkit-gnome-authentication-agent-1

# Variables {{{1
set $mod Mod1
set $modsys Mod4
set $left h
set $down j
set $up k
set $right l
set $term kitty
# set $menu dmenu_path | wofi -d --gtk-dark | xargs swaymsg exec --
set $menu fuzzel -T kitty -i Papirus-Dark -b 000000ff -t ffffffff -s 777777ff -C 000000ff -B 8 -r 0 -w 48 | xargs swaymsg exec --
set $dmenu fuzzel -d -f monospace:size=10 -T kitty -i Papirus-Dark -b 000000ff -t ffffffff -s 777777ff -C 000000ff -B 8 -r 0 -w 80 | xargs swaymsg exec --
set $lock 'swaylock -f -c 333333'

set $ws1 workspace number 1
set $ws2 workspace number 2
set $ws3 workspace number 3
set $ws4 workspace number 4
set $ws5 workspace number 5
set $ws6 workspace number 6

# Colors {{{1
# set $color_white  #FFFFFF
# set $color_gray #777777
# set $color_accent #216609
# set $color_black #000000

# Colors                  border                 background             text                   indicator            child_border
# client.focused            $color_white  	 $color_black     	$color_black   	       $color_accent        $color_accent
# client.focused_inactive   $color_black           $color_black           $color_black           $color_accent        $color_gray
# client.unfocused          $color_black 		 $color_black           $color_black           $color_accent        $color_gray
# client.urgent             $color_bright_yellow   $color_bright_yellow   $color_normal_black    $color_unused        $color_unused
# client.placeholder        $color_unused          $color_unused          $color_unused          $color_unused        $color_unused

# Rules {{{1
for_window 	[app_id="firefox"] 	move container to $ws1

# Outputs {{{1
output * bg "#000000" solid_color
output * adaptive_sync on
output DP-1 pos 0 0 scale 2 res 3840x2160 
output DP-2 pos 1920 0 scale 2 res 3840x2160 

# Inputs {{{1
input * {
    xkb_layout "us,ru"
    xkb_options grp:shifts_toggle
}
input "type:keyboard" repeat_delay 300
input "type:keyboard" repeat_rate 30

input "type:pointer" {
    accel_profile adaptive
    natural_scroll disabled
    scroll_factor 1
}

seat seat0 hide_cursor 5000

# Settings {{{1
font pango:monospace 10
default_border pixel 2
smart_borders on
smart_gaps on
gaps inner 0
gaps outer 0
hide_edge_borders --i3 none
focus_wrapping yes

# Idle config {{{1
exec swayidle -w \
         timeout 300 'swaylock -f -c 333333' \
         timeout 600 'swaymsg "output * dpms off"' \
	 timeout 1200 'loginctl suspend' \
	 resume 'swaymsg "output * dpms on"' \
         before-sleep 'swaylock -f -c 333333'

# Key bindings {{{1
# System & programs {{{2
    bindsym XF86AudioRaiseVolume exec pamixer -ui 2 && pamixer --get-volume > $SWAYSOCK.wob
    bindsym XF86AudioLowerVolume exec pamixer -ud 2 && pamixer --get-volume > $SWAYSOCK.wob
    bindsym XF86AudioMute exec pamixer --toggle-mute && ( pamixer --get-mute && echo 0 > $SWAYSOCK.wob ) || pamixer --get-volume > $SWAYSOCK.wob

    bindsym XF86MonBrightnessDown exec doas ddcutil -d 1 setvcp 10 - 25 && doas ddcutil -d 1 --brief getvcp 10 | awk '{print $4}' > $SWAYSOCK.wob
    bindsym XF86MonBrightnessUp exec doas ddcutil -d 1 setvcp 10 + 25 && doas ddcutil -d 1 --brief getvcp 10 | awk '{print $4}' > $SWAYSOCK.wob
    bindsym Shift+XF86MonBrightnessDown exec doas ddcutil -d 2 setvcp 10 - 25 && doas ddcutil -d 2 --brief getvcp 10 | awk '{print $4}' > $SWAYSOCK.wob
    bindsym Shift+XF86MonBrightnessUp exec doas ddcutil -d 2 setvcp 10 + 25 && doas ddcutil -d 2 --brief getvcp 10 | awk '{print $4}' > $SWAYSOCK.wob

    bindsym $modsys+BackSpace reload

    bindsym $modsys+Ctrl+c exec clipman pick -t STDOUT | $dmenu
    bindsym $modsys+Return exec $term
    bindsym $modsys+d exec $menu

set $Pause -- [L]ock -- [E]xit -- [S]uspend -- [R]eboot -- [P]oweroff --
mode "$Pause" {
    bindsym L       exec $lock,                 mode "default"
    bindsym E       exec swaymsg exit,          mode "default"
    bindsym S       exec loginctl suspend,      mode "default"
    bindsym R       exec loginctl reboot,       mode "default"
    bindsym P       exec loginctl poweroff -i,  mode "default"
 
    bindsym Return  mode "default"
    bindsym Escape  mode "default"
}
bindsym $modsys+Shift+BackSpace mode "$Pause" 

# Windows {{{2
    bindsym $modsys+Shift+q kill
    floating_modifier $mod normal

# Moving around {{{2
    bindsym $mod+$left focus left
    bindsym $mod+$down focus down
    bindsym $mod+$up focus up
    bindsym $mod+$right focus right

    bindsym $mod+Ctrl+h focus output left
    bindsym $mod+Ctrl+l focus output right

    bindsym $mod+Shift+$left move left
    bindsym $mod+Shift+$down move down
    bindsym $mod+Shift+$up move up
    bindsym $mod+Shift+$right move right

    bindsym $mod+Ctrl+Shift+h move workspace to output left
    bindsym $mod+Ctrl+Shift+l move workspace to output right

# Workspaces {{{2
    bindsym $mod+q $ws1
    bindsym $mod+w $ws2
    bindsym $mod+e $ws3
    bindsym $mod+a $ws4
    bindsym $mod+s $ws5
    bindsym $mod+d $ws6
    bindsym $mod+tab workspace back_and_forth
    bindsym $mod+Ctrl+j workspace next
    bindsym $mod+Ctrl+k workspace prev

    bindsym $mod+Shift+q move container to $ws1
    bindsym $mod+Shift+w move container to $ws2
    bindsym $mod+Shift+e move container to $ws3
    bindsym $mod+Shift+a move container to $ws4
    bindsym $mod+Shift+s move container to $ws5
    bindsym $mod+Shift+d move container to $ws6

# Layout stuff {{{2
    bindsym $mod+z split toggle
    bindsym $mod+c layout toggle split
    bindsym $mod+f fullscreen
    bindsym $mod+Shift+space floating toggle
    bindsym $mod+Escape focus mode_toggle

# Scratchpad {{{2
    bindsym $mod+Shift+minus move scratchpad
    bindsym $mod+minus scratchpad show

# Resize mode  {{{2
mode "-- RESIZE --" {
    bindsym $left resize shrink width 20px
    bindsym $down resize grow height 20px
    bindsym $up resize shrink height 20px
    bindsym $right resize grow width 20px

    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "-- RESIZE --"

# Status bar {{{1
bar {
    swaybar_command waybar
    # position top
    # tray_output all

    # status_command i3status-rs ~/.config/sway/status.toml

    # colors {
    #     statusline 		$color_white
    #     background 		$color_black
    #     inactive_workspace 	$color_black 	$color_black 	$color_gray
    # }
}

include /etc/sway/config.d/*
